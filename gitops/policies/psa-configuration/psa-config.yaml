apiVersion: apiserver.config.k8s.io/v1
kind: AdmissionConfiguration
plugins:
- name: PodSecurity
  configuration:
    apiVersion: pod-security.admission.config.k8s.io/v1
    kind: PodSecurityConfiguration
    defaults:
      enforce: "restricted"
      enforce-version: "latest"
      audit: "restricted"
      audit-version: "latest"
      warn: "restricted"
      warn-version: "latest"
    exemptions:
      # Exemptions must be explicitly configured
      usernames: []
      runtimeClasses: []
      namespaces:
        - kube-system
        - kube-node-lease
        - kube-public
      # Service accounts in these namespaces are exempt
      # (for system components that need privileged access)