apiVersion: v1
kind: ConfigMap
metadata:
  name: encryption-config-example
  namespace: encryption-sim-lab
  annotations:
    cks.exercise: "03-encryption-at-rest"
    cks.file: "simulated-encryption-config.yaml"
data:
  encryption-config.yaml: |
    # EXAMPLE ENCRYPTION CONFIGURATION (For Learning Only)
    # This simulates what would be in /etc/kubernetes/encryption-config.yaml
    apiVersion: apiserver.config.k8s.io/v1
    kind: EncryptionConfiguration
    resources:
      - resources:
          - secrets
        providers:
          - aescbc:
              keys:
                - name: key1
                  # Base64 encoded 32-byte key (SIMULATED)
                  secret: c2ltdWxhdGVkLWtleS1mb3ItbGVhcm5pbmctcHVycG9zZXM=
          - identity: {}  # Fallback for decryption
      - resources:
          - configmaps
        providers:
          - identity: {}  # ConfigMaps not encrypted by default
  kube-apiserver-patch.yaml: |
    # Example of what would be added to kube-apiserver manifest
    spec:
      containers:
      - name: kube-apiserver
        command:
        - kube-apiserver
        - --encryption-provider-config=/etc/kubernetes/encryption-config.yaml
        # Other args...