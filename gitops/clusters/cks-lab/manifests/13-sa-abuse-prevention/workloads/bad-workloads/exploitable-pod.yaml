apiVersion: v1
kind: Pod
metadata:
  name: exploitable-pod
  namespace: sa-security-test
  labels:
    cks-lab: "13-sa-abuse-prevention"
    security-risk: "high"
    purpose: "demonstration-only"
  annotations:
    warning: "This pod demonstrates insecure service account usage - DO NOT USE IN PRODUCTION"
    attack-vector: "Token theft and privilege escalation"
spec:
  # BAD: Using default service account
  serviceAccountName: default
  
  # BAD: Automounting token (default behavior)
  automountServiceAccountToken: true
  
  containers:
  - name: exploitable-container
    image: bitnami/kubectl:latest
    command: ["sleep", "3600"]
    
    # BAD: Running as root
    securityContext:
      runAsUser: 0
      privileged: false
      
    # BAD: Mounting host directories
    volumeMounts:
    - name: host-root
      mountPath: /host
      readOnly: false
  
  # BAD: Mounting host filesystem
  volumes:
  - name: host-root
    hostPath:
      path: /
      type: Directory
  
  restartPolicy: Never