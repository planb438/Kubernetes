apiVersion: v1
kind: Pod
metadata:
  name: bad-root-pod
  namespace: pod-security-lab
  annotations:
    cks.exercise: "04-pod-security-context"
    cks.section: "01-run-as-non-root"
    cks.example: "bad"
    cks.expected: "This pod should FAIL due to runAsNonRoot enforcement"
spec:
  containers:
  - name: root-container
    image: nginx:alpine  # This runs as root by default!
    securityContext:
      runAsUser: 0  # Explicitly running as root
      runAsNonRoot: false
    command: ["sleep", "3600"]
---
apiVersion: batch/v1
kind: Job
metadata:
  name: test-root-pod
  namespace: pod-security-lab
spec:
  ttlSecondsAfterFinished: 300
  template:
    spec:
      restartPolicy: Never
      containers:
      - name: tester
        image: bitnami/kubectl:latest
        command: ["/bin/sh", "-c"]
        args:
        - |
          echo "Testing root pod deployment..."
          echo "This should FAIL due to Pod Security Standards:"
          kubectl apply -f bad-pod.yaml 2>&1 | grep -A5 -B5 "Error"
          echo ""
          echo "Expected error: 'runAsNonRoot' violation"